{
  "version": 3,
  "sources": ["../../../src/scripts/pages/accounts/AccountItem.ts", "../../../src/scripts/pages/accounts/index.ts"],
  "sourcesContent": ["export default class AccountItem {\n    private template: HTMLTemplateElement | null;\n    private totalBuyAmount = 0; // \uCD1D \uB9E4\uC218\uAE08\uC561\n    private totalGainsLosses = 0; // \uCD1D \uD3C9\uAC00\uC190\uC775\n    // private totalReturnRates = 0;\n    // private size = 0;\n\n    constructor() {\n        this.template = document.querySelector(\"#accountsItem\");\n    }\n\n    private toLocalStringRounded(value: number): string {\n        return Math.round(value).toLocaleString();\n    }\n\n    render(data: AccountExtend): HTMLElement | null {\n        if (!this.template) {\n            console.error(\"Template is not found.\");\n            return null;\n        }\n\n        const {\n            avg_buy_price, // \uB9E4\uC218\uD3C9\uADE0\uAC00\n            // avg_buy_price_modified,  // \uB9E4\uC218\uD3C9\uADE0\uAC00 \uC218\uC815 \uC5EC\uBD80\n            // balance, // \uC8FC\uBB38\uAC00\uB2A5 \uAE08\uC561/\uC218\uB7C9\n            buy_price,\n            currency,\n            // locked, // \uC8FC\uBB38 \uC911 \uBB36\uC5EC\uC788\uB294 \uAE08\uC561/\uC218\uB7C9\n            unit_currency, // \uD3C9\uB2E8\uAC00 \uAE30\uC900 \uD654\uD3D0\n            volume, //  \uBCF4\uC720\uC218\uB7C9\n            trade_price, // \uD604\uC7AC \uAC00\uACA9\n        } = data;\n\n        const difference = trade_price - avg_buy_price;\n        const gainsLosses = difference * volume;\n        const appraisalPrice = buy_price + gainsLosses;\n        const returnRate = (difference / avg_buy_price) * 100;\n\n        this.totalBuyAmount += buy_price;\n        this.totalGainsLosses += gainsLosses;\n        // this.totalReturnRates += returnRate;\n        // this.size += 1;\n\n        const values = {\n            h3: currency,\n            \".volume .value\": volume.toString(),\n            \".avgBuyPrice .value\": this.toLocalStringRounded(avg_buy_price),\n            \".buyPrice .value\": this.toLocalStringRounded(buy_price),\n            \".gainsLosses .value\": this.toLocalStringRounded(gainsLosses),\n            \".returnRate .value\": returnRate.toFixed(2),\n            \".appraisalPrice .value\": this.toLocalStringRounded(appraisalPrice),\n        };\n\n        const template = this.template.content.firstElementChild;\n        const element = template?.cloneNode(true) as HTMLElement;\n\n        for (const [selector, value] of Object.entries(values)) {\n            element.querySelector(selector)!.textContent = value;\n        }\n\n        element.querySelectorAll(\".unit\").forEach((el) => {\n            el.textContent = unit_currency;\n        });\n\n        return element;\n    }\n\n    tradeAsset(asset: Asset) {\n        const { balance, locked } = asset;\n        const amount = Number(balance) + Number(locked); // \uBCF4\uC720 KRW\n        const totalAmount = this.totalBuyAmount + amount; // \uCD1D \uBCF4\uC720\uC790\uC0B0\n        const totalAppraisalPrice = this.totalBuyAmount + this.totalGainsLosses; // \uCD1D \uD3C9\uAC00\uAE08\uC561\n\n        const values = {\n            \".amount .value\": Math.round(amount).toLocaleString(),\n            \".totalAmount .value\": Math.round(totalAmount).toLocaleString(),\n            \".totalBuyAmount .value\": Math.round(\n                this.totalBuyAmount\n            ).toLocaleString(),\n            \".totalGainsLosses .value\": Math.round(\n                this.totalGainsLosses\n            ).toLocaleString(),\n            \".totalAppraisalPrice .value\":\n                Math.round(totalAppraisalPrice).toLocaleString(),\n        };\n\n        for (const [selector, value] of Object.entries(values)) {\n            document.querySelector(selector)!.textContent = value;\n        }\n\n        // const totalReturnRate = this.totalReturnRates / this.size; // \uCD1D \uD3C9\uAC00\uC218\uC775\uB960\n\n        // document.querySelector(\".totalReturnRate .value\")!.textContent =\n        // totalReturnRate.toFixed(2);\n    }\n}\n", "import AccountItem from \"./AccountItem\";\n\nclass AccountManager {\n    constructor() {\n        this.initializeAccounts();\n    }\n\n    private async fetchData(url: string) {\n        try {\n            const response = await fetch(url, { method: \"GET\" });\n            const data = await response.json();\n            return data;\n        } catch (error) {\n            console.warn(error instanceof Error ? error.message : error);\n        }\n    }\n\n    private async initializeAccounts() {\n        const { krwAsset, myMarkets } = await this.fetchData(\"/getAccounts\");\n        this.updateAccountsWithTickers(myMarkets, krwAsset);\n    }\n\n    private async updateAccountsWithTickers(\n        myAccounts: Account[],\n        krwAsset: Asset\n    ) {\n        const tickers = await this.fetchData(\"/getTickers\");\n        const chance = await this.fetchData(\"/getChance\");\n\n        console.log(chance);\n\n        this.combineAccountsWithTickers(myAccounts, tickers, krwAsset);\n    }\n\n    private combineAccountsWithTickers(\n        myAccounts: Account[],\n        ticekrs: Ticker[],\n        krwAsset: Asset\n    ) {\n        if (myAccounts.length === undefined) return;\n\n        const data = myAccounts.map((account, index) => {\n            const { trade_price } = ticekrs[index];\n            return {\n                ...account,\n                trade_price,\n            };\n        });\n\n        this.displayAccounts(data, krwAsset);\n    }\n\n    private displayAccounts(myAccounts: AccountExtend[], krwAsset: Asset) {\n        const accountItem = new AccountItem();\n        const fragment = new DocumentFragment();\n\n        myAccounts\n            .map((account) => accountItem.render(account))\n            .forEach((element) => fragment.appendChild(element!));\n\n        document.querySelector(\".accountsList\")?.appendChild(fragment);\n\n        accountItem.tradeAsset(krwAsset);\n    }\n}\n\nnew AccountManager();\n"],
  "mappings": "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",
  "names": []
}
